function customImagePageInit(){selectedPageBackground(),displayDailyQuote(),display_greeting(),getImageIds();var a=2e3;displayCurrentTime(),nIntervId=setInterval(function(){displayCurrentTime()},a)}function selectedPageBackground(){chrome.storage.sync.get("page_background_image",function(a){if(void 0!=a.page_background_image){var b=localStorage.getItem(a.page_background_image);page_wraper.style.backgroundImage="url("+b+")";var c=setInterval(function(){page_wraper.style.opacity=1,clearInterval(c)},5)}else{page_wraper.style.backgroundImage="url(images/back2.jpg)";var c=setInterval(function(){page_wraper.style.opacity=1,clearInterval(c)},5)}})}function displayDailyQuote(){chrome.storage.sync.get("quote",function(a){void 0!=a.quote&&(quote_wraper.innerHTML=a.quote)})}function getImageIds(){chrome.storage.sync.get("image_change_time",function(a){if(void 0!=a.image_change_time){var b=getCurrentDate(),c=a.image_change_time;is_next_day=b.day!=c.day,is_next_day?navigator.onLine?chrome.storage.sync.set({image_processed:image_refreshed},function(){generateImageRandomIds()}):(image_refreshed=[!0,!0,!0],chrome.storage.sync.set({image_processed:image_refreshed},function(){generateImageRandomIds()})):chrome.storage.sync.get("image_processed",function(a){if(void 0!=a.image_processed)for(var b=0;b<=2;b++)image_refreshed[b]=a.image_processed[b];generateImageRandomIds()})}else is_next_day=!0,chrome.storage.sync.get("image_processed",function(a){if(void 0!=a.image_processed)for(var b=0;b<=2;b++)image_refreshed[b]=a.image_processed[b];generateImageRandomIds()})})}function generateImageRandomIds(a){var a=a||0;if(navigator.onLine||(is_next_day=!1),is_next_day){createImageThumbs();var b="https://source.unsplash.com/random",c=convertFileToDataURLviaFileReader;c(b,function(a){localStorage.setItem(0,a);var b=getCurrentDate();chrome.storage.sync.set({image_change_time:b},function(){}),image_refreshed[0]=!0,chrome.storage.sync.set({image_processed:image_refreshed},function(){}),createImageThumbs(1),generateNewThumbs()}),getQuote()}else 0!=a&&navigator.onLine?(createImageThumbs(0,a),generateNewThumbs(a)):getUnprocessedImages()}function getUnprocessedImages(){for(var a=0,b=0;b<image_refreshed.length;b++)0==image_refreshed[b]&&navigator.onLine&&(generateNewThumbs(b),a=1);0==a&&createImageThumbs()}function generateNewThumbs(a){var b=a||0,c=screen.width,d=screen.height,e="https://source.unsplash.com/random/"+c+"x"+d,f=1,g="";0!=b&&(f=b);var i=function(){f<=IMAGE_LIMIT?f!=b&&0!=b||1==image_refreshed[f]?(f++,setTimeout(function(){i()},200)):chrome.storage.sync.get("fav_images",function(a){if(void 0!=a.fav_images)if("true"==a.fav_images[f]&&void 0!=a.fav_images)image_refreshed[f]=!0,chrome.storage.sync.set({image_processed:image_refreshed},function(){}),f++,i();else{var b=convertFileToDataURLviaFileReader;b(e,function(a){g!=a&&(localStorage.setItem(f,a),image_refreshed[f]=!0,chrome.storage.sync.set({image_processed:image_refreshed},function(){}),f++,g=a,createImageThumbs(),setTimeout(function(){i()},200))})}else{var b=convertFileToDataURLviaFileReader;b(e,function(a){g!=a&&(localStorage.setItem(f,a),image_refreshed[f]=!0,chrome.storage.sync.set({image_processed:image_refreshed},function(){}),f++,g=a,createImageThumbs(),setTimeout(function(){i()},200))})}}):createImageThumbs(1)};i(localStorage.length)}function createImageThumbs(a,b){var a=a||0,d=document.getElementById("thumbs");d.innerHTML=" ";var e="",f=!1,g="images/star.png",h="transparent",i="";chrome.storage.sync.get("fav_images",function(c){void 0!=c.fav_images&&(e=c.fav_images);for(var j=0;j<localStorage.length;j++){var k=document.createElement("li"),l=localStorage.getItem(j),m=localStorage.key(j);if("true"==e[j]?(h="#eb9c2d",f=!0,g="images/star_fill.png",i=""):(h="transparent",f=!1,g="images/star.png",i=0==image_refreshed[j]?"loading-image":""),0!=j)var n="<input type='radio' class='img-option' id='ext-image-"+j+"' name='image-select' value='"+m+"'> <label for='ext-image-"+j+"'><img style='border-color:"+h+";' src='"+l+"'><span class='"+i+"'></span></label><span class='make-fav'><img src="+g+" class='fav-img' data-fav="+f+" data-id='"+j+"'></span>";else var n="<input type='radio' class='img-option' id='ext-image-"+j+"' name='image-select' value='"+m+"'> <label for='ext-image-"+j+"'><img src='"+l+"'><span class='"+i+"'></span></label>";k.innerHTML=n,d.appendChild(k),(is_next_day&&0==a||0==image_refreshed||j==b&&0!=b)&&change_star_visibility("none"),j==localStorage.length-1&&chrome.storage.sync.get("page_background_image",function(a){void 0==a.page_background_image&&setTimeout(function(){document.getElementsByClassName("img-option")[0].click()},500),fav_image_action()})}changeBackgroundImage()})}function getCurrentDate(){var a=new Date,b=a.getDate(),c=a.getMonth()+1,d=a.getFullYear(),e=a.getHours(),f=a.getMinutes();return{year:d,month:c,day:b,hours:e,minutes:f}}function changeBackgroundImage(){selectedPageBackground();for(var a=document.getElementsByClassName("img-option"),b=0;b<a.length;b++)a[b].addEventListener("change",function(){image_src=localStorage.getItem(this.value),chrome.storage.sync.set({page_background_image:this.value},function(){page_wraper.style.backgroundImage="url("+image_src+")"})})}function convertFileToDataURLviaFileReader(a,b){var c=new XMLHttpRequest;c.responseType="blob",c.onload=function(){var a=new FileReader;a.onloadend=function(){b(a.result)},a.readAsDataURL(c.response)},c.open("GET",a),c.send()}function convertFileToDataURLviaFileReader2(a,b){var c=new XMLHttpRequest;c.responseType="text/javascript",c.onload=function(){var a=new FileReader;a.onloadend=function(){b(a.result)},a.readAsDataURL(c.response)},c.open("GET",a),c.send()}function getQuote(){var a=Math.floor(437*Math.random()),b=quotes[a];chrome.storage.sync.set({quote:b},function(){}),displayDailyQuote()}function displayCurrentTime(){var a=new Date,b=a.getMonth(),c=a.getHours(),d=a.getMinutes(),f=(a.getSeconds(),a.getDate()),g=a.getFullYear(),h=["January","February","March","April","May","June","July","August","September","October","November","December"];c<10&&(c="0"+c),d<10&&(d="0"+d);var i=c+" : "+d;i+="<span>"+h[b]+" / "+f+" / "+g+"</span>",time_wraper.innerHTML=i}function fav_image_action(){for(var a=document.getElementsByClassName("fav-img"),b=[],c=0;c<a.length;c++)a[c].addEventListener("click",function(){var a=this.dataset.id;"true"==this.dataset.fav?(this.src="images/star.png",this.dataset.fav=!1,fav_image_action_popup("Image Removed from Favourite !","error"),document.querySelector("label[for=ext-image-"+a+"] img").style.borderColor="#fff",get_image_fav_time(a)):(this.src="images/star_fill.png",this.dataset.fav=!0,fav_image_action_popup("Image Saved as Favourite !","success"),document.querySelector("label[for=ext-image-"+a+"] img").style.borderColor="#eb9c2d",set_image_fav_time(a));var c=this.dataset.fav;chrome.storage.sync.get("fav_images",function(d){void 0!=d.fav_images&&(b=d.fav_images),b[a]=c,chrome.storage.sync.set({fav_images:b},function(){})})})}function set_image_fav_time(a){var b=getCurrentDate(),c={};chrome.storage.sync.get("fav_images_time",function(d){if(void 0!=d.fav_images_time)for(var e=Object.keys(d.fav_images_time).length,f=1;f<=e;f++)c[f]=d.fav_images_time[f];c[a]=b,chrome.storage.sync.set({fav_images_time:c},function(){})})}function get_image_fav_time(a){navigator.onLine&&chrome.storage.sync.get("fav_images_time",function(b){if("object"==typeof b.fav_images_time[a]){var c=getCurrentDate();c.day!=b.fav_images_time[a].day&&(image_refreshed[a]=!1,chrome.storage.sync.set({image_processed:image_refreshed},function(){change_star_visibility("none"),generateImageRandomIds(a)}))}})}function change_star_visibility(a){for(var b=document.getElementsByClassName("make-fav"),c=0;c<=b.length-1;c++)b[c].style.display=a}function fav_image_action_popup(a,b){var c=document.getElementById("alert"),d=c.getElementsByClassName("content")[0];d.innerHTML=a,"success"==b?d.style.color="#078a07":d.style.color="#9a0909",document.getElementById("alert").className="active",setTimeout(function(){d.innerHTML="",document.getElementById("alert").className=""},2500)}function display_greeting(){var a=new Date,b=a.getHours(),c="",d=document.getElementById("greetings");c=b<12?"Good Morning":b<18?"Good Afternoon":"Good Evening",d.innerHTML=c}var selected_background,bing_frame=document.getElementById("frame"),bing_opt=document.getElementById("bing-wrapper"),google_opt=document.getElementById("google-wrapper"),custom_opt=document.getElementById("custom-wrapper"),time_wraper=document.getElementById("current-time"),page_wraper=document.getElementsByClassName("back-page")[0];const IMAGE_LIMIT=2;var quote_wraper=document.getElementById("quote"),is_next_day=!1,image_refreshed=[!1,!1,!1];chrome.storage.sync.get("selected_background",function(a){switch(a.selected_background){case"google":window.location.href="https://www.google.com";break;case"bing":bing_opt.style.display="block",bing_frame.src="https://www.bing.com";break;default:custom_opt.style.display="block",customImagePageInit()}});